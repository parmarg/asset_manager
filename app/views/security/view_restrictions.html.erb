<%= render :template => 'shared/navbar',:locals => {:assetsNav => false, :searchNav => false,:adminNav => true} %>
<ul class="breadcrumb">
  <li><%= link_to "Security", :controller =>"security",:action =>"index" %><span class="divider">/</span></li>
  <li class="active"><%= link_to "Scheme "+@security.name, :controller =>"security",:action =>"view_restrictions",:id => @security.id %></li>
</ul>
<%  if @securityName != nil %>
    <div class="alert alert-success">
      Security Scheme <%= @securityName %> Successfully <%= @securityAction %>
    </div>
<% end %>
<table class="table table-hover">
  <tr>
    <th>Asset Type</th>
    <th>Restriction Type</th>
    <th>Restricted To</th>
    <th>Actions</th>
  </tr>
  <tr style="background-color: white;">
    <td style="text-align: center;">
      <%= AssetType.find(@security.asset_type_id).name %>
    </td>
    <td style="text-align: center;">
      Create
    </td>
    <td style="text-align: center;">
      <%= render :template => 'security/individual_perms',:locals => {:restrictions => @security.create_restrictions} %>
    </td>
    <td style="text-align: center;">
      <%= render :template => 'security/security_actions', :locals =>{:restrictions => @security.create_restrictions,:security_type => 'create',:security_id =>@security.id } %>
    </td>
  </tr>
  <tr style="background-color: white;">
    <td style="text-align: center;">
      <%= AssetType.find(@security.asset_type_id).name %>
    </td>
    <td style="text-align: center;">
      Edit
    </td>
    <td style="text-align: center;">
      <%= render :template => 'security/individual_perms',:locals => {:restrictions => @security.edit_restrictions} %>
    </td>
    <td style="text-align: center;">
      <%= render :template => 'security/security_actions', :locals =>{:restrictions => @security.edit_restrictions,:security_type => 'edit',:security_id =>@security.id } %>
    </td>
  </tr>
  <tr style="background-color: white;">
    <td style="text-align: center;">
      <%= AssetType.find(@security.asset_type_id).name %>
    </td>
    <td style="text-align: center;">
      View
    </td>
    <td style="text-align: center;">
      <%= render :template => 'security/individual_perms',:locals => {:restrictions => @security.view_restrictions} %>
    </td>
    <td style="text-align: center;">
      <%= render :template => 'security/security_actions', :locals =>{:restrictions => @security.view_restrictions,:security_type => 'view',:security_id =>@security.id } %>
    </td>
  </tr>
  <tr style="background-color: white;">
    <td style="text-align: center;">
      <%= AssetType.find(@security.asset_type_id).name %>
    </td>
    <td style="text-align: center;">
      Delete
    </td>
    <td style="text-align: center;">
      <%= render :template => 'security/individual_perms',:locals => {:restrictions => @security.delete_restrictions} %>
    </td>
    <td style="text-align: center;">
      <%= render :template => 'security/security_actions', :locals =>{:restrictions => @security.delete_restrictions,:security_type => 'delete',:security_id =>@security.id } %>
    </td>
  </tr>
</table>
